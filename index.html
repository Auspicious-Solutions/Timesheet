<!DOCTYPE html>
<html>
<head>
  <title>Timesheet</title>
  <style>
    body { font-family: Arial; padding: 20px; }
    table { border-collapse: collapse; width: 100%; }
    th, td { border: 1px solid #ccc; padding: 8px; }
    th { background-color: #f0f0f0; }
    input { width: 100%; border: none; background: transparent; }
    .action-btn { background: #007bff; color: white; padding: 5px 10px; border: none; border-radius: 5px; cursor: pointer; }
  </style>
</head>
<body>

<h2>Online Timesheet (GitHub Compatible)</h2>

<table id="timesheet">
  <thead>
    <tr>
      <th>Date</th>
      <th>Start Time</th>
      <th>End Time</th>
      <th>Client</th>
      <th>Work Type</th>
      <th>Description</th>
      <th>Sub Client</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<br>
<button onclick="startTask()" class="action-btn">Start Task</button>
<button onclick="saveData()" class="action-btn">Save Locally</button>
<button onclick="loadData()" class="action-btn">Load Saved</button>

<script>
  function getCurrentDateTime() {
    const now = new Date();
    const date = now.toISOString().split("T")[0];
    const time = now.toTimeString().split(" ")[0];
    return { date, time };
  }

  function startTask() {
    const table = document.querySelector("#timesheet tbody");
    const { date, time } = getCurrentDateTime();

    // Set end time of last row
    const lastRow = table.rows[table.rows.length - 1];
    if (lastRow) {
      const endTimeInput = lastRow.cells[2].querySelector("input");
      if (endTimeInput && !endTimeInput.value) {
        endTimeInput.value = time;
      }
    }

    // Add new row
    const row = table.insertRow();
    const fields = [date, time, '', '', '', '', ''];

    for (let i = 0; i < fields.length; i++) {
      const cell = row.insertCell();
      const input = document.createElement("input");
      input.type = "text";
      input.value = fields[i];
      cell.appendChild(input);
    }
  }

  function saveData() {
    const rows = document.querySelectorAll("#timesheet tbody tr");
    const data = [];

    rows.forEach(row => {
      const inputs = row.querySelectorAll("input");
      const rowData = Array.from(inputs).map(input => input.value);
      data.push(rowData);
    });

    localStorage.setItem("timesheetData", JSON.stringify(data));
    alert("Data saved locally!");
  }

  function loadData() {
    const data = JSON.parse(localStorage.getItem("timesheetData") || "[]");
    const table = document.querySelector("#timesheet tbody");
    table.innerHTML = "";

    data.forEach(rowData => {
      const row = table.insertRow();
      rowData.forEach(value => {
        const cell = row.insertCell();
        const input = document.createElement("input");
        input.type = "text";
        input.value = value;
        cell.appendChild(input);
      });
    });
  }
</script>

</body>
</html>
